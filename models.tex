% Created 04-03-2016
% Put the atmospheric graph and drag coefficient graph fit in 19-09-2016
% 15-11-2016 add equations for state, state derivatives, gravity thrust and drag from early versions and used for RKF
% 17-11-2016 Remembered that I have to include a section on the cirularisation. And included the numbers for the speed of sound contant parameters.
% Updated 05-02-2017 implementation of feedback


\chapter{Models} 
\label{ch:models}
The \ac{MAV} and the corresponding ascent can be modelled in many different ways. Depending on the desired accuracy of the final solution compared to the real-life expected trajectory, different perturbations and freedom in motion can be defined and included, ranging from a low-fidelity (3DOF) to a high-fidelity program (6DOF). In a 3DOF system only the translational motion is taken into account, in 6DOF the rotational motion is also included, which makes it more accurate and more representative of a real-life scenario.

The main goal of this thesis is to determine if \ac{TSI} is an integrator that can be used for ascent cases and determine its performance compared to previously established methods. This comparison can be done with a less accurate representation of reality, because this allows for faster computations. Also, should the model be a 6DOF system, the extra accuracy would not have an added value because of all the errors in the assumptions made. Therefore a 3DOF system will suffice for the purposes of this research. In this 3DOF simulation the \ac{MAV} system can be modelled as a point-mass system with different accelerations acting on it. The change in position can be described by the kinematic equations and the change in velocity by the corresponding dynamic equations. The change in mass is described by the mass-flow. All these equations are provided in \Cref{sec:stateAndStateDerivatives}. For this model, three perturbing accelerations will be taken into account: gravity, thrust and atmospheric drag. The effect of third bodies can be neglected because of the short mission duration. All the accelerations are described in \Cref{sec:gravityModel,sec:thrustModel,sec:dragModel}, respectively. At the end of the integration, an impulsive shot is executed to circularise the orbit as described in \Cref{sec:modelCircularisation}.

\section{State And State Derivatives}
\label{sec:stateAndStateDerivatives}
%\textbf{\textcolor{red}{Maybe include more assumptions and corresponding explanations!!}}

In this research problem, different perturbations are best modelled in different reference frames. One example is the drag acceleration acting in the aerodynamic frame. However, the integration will be performed in the inertial frame. A collection of all the different frames required is shown in \Cref{fig:allFiveReferenceFrames_mooij2013fd-trinidad2012-mooij1994motion}.

\begin{figure}[H]
\centering
\subfloat[]{\includegraphics[width=0.5\textwidth]{figures/reference_frames/eci_mooij2013fd_noBox.jpg}\label{subfig:eci_mooij2013fd_noBox}} 
\subfloat[]{\includegraphics[width=0.5\textwidth]{figures/reference_frames/ecef_mooij2013fd_noBox.jpg} \label{subfig:ecef_mooij2013fd_noBox}}\\
 
\subfloat[]{\includegraphics[width=0.5\textwidth]{figures/reference_frames/vcne_mooij2013fd_noBox.jpg}\label{subfig:vcne_mooij2013fd_noBox}} 
\subfloat[]{\includegraphics[width=0.5\textwidth]{figures/reference_frames/baseline_liquid_trinidad2012_bframe.jpg}\label{subfig:baseline_liquid_trinidad2012_bframe}}\\

\subfloat[]{\includegraphics[width=0.5\textwidth]{figures/reference_frames/propframe_mooij1994motion.jpg}\label{subfig:propframe_mooij1994motion}}



\caption{Used reference frames \protect\subref{subfig:eci_mooij2013fd_noBox} (Mars centred) Inertial frame, \protect\subref{subfig:ecef_mooij2013fd_noBox} (Mars centred) Rotational frame, \protect\subref{subfig:vcne_mooij2013fd_noBox} (Vehicle centred) Vertical frame \citep{mooij2013fd}, \protect\subref{subfig:baseline_liquid_trinidad2012_bframe} (Vehicle centred) Body frame \citep{trinidad2012} and \protect\subref{subfig:propframe_mooij1994motion} (Vehicle centred) Propulsion frame \citep{mooij1994motion}. } 
\label{fig:allFiveReferenceFrames_mooij2013fd-trinidad2012-mooij1994motion} 
\end{figure} 


%\begin{figure}[H]
%\centering
%\includegraphics[width=1.0\textwidth]{figures/reference_frames/allFiveReferenceFrames_mooij2013fd-trinidad2012-mooij1994motion.jpg}
%\caption{a) (Mars centred) Inertial frame, b) (Mars centred) Rotational frame, c) (Vehicle centred) Vertical frame \citep{mooij2013fd}. d) (Vehicle centred) Body frame \citep{trinidad2012}. e) (Vehicle centred) Propulsion frame \citep{mooij1994motion}.}
%\label{fig:allFiveReferenceFrames_mooij2013fd-trinidad2012-mooij1994motion}
%\end{figure}

\noindent
This means that the accelerations have to be translated into the inertial frame through the presented frames. One way to do this is by using so-called transformation matrices ($\mathbb{T}$). These transformation matrices are composed of rotations around different axes over an associated angle $\phi$. An alternative would be to use quaternions instead, which make use of complex numbers. However, due to the workings of \ac{TSI} this was not easily implemented here which is why normal Euler angle transformations were used as the baseline for the rotation equations.  \Cref{fig:exampleXtrans_mooij2013stat} shows a general rotation around the x-axis. When this is set in a matrix, the transformation over the x-, y- and z-axis can be defined in the respective transformation matrices as described by \Cref{eq:allTransMatr}. 

\nomenclature[Rb0]{$\mathbb{T}$}{Transformation matrix \nomunit{-}}

\begin{figure}[!ht]
\centering
\includegraphics[width=0.5\textwidth]{figures/reference_frames/xtrans_mooij2013stat.jpg}
\caption{General rotation around the x-axis \citep{mooij2013stat}.}
\label{fig:exampleXtrans_mooij2013stat}
\end{figure}


\begin{equation} \label{eq:allTransMatr}
\mathbb{T}_{\mathbf{x}}(\phi)=\begin{bmatrix}
1 & 0 & 0 \\
0 & \cos\phi & \sin\phi \\
0 & -\sin\phi & \cos\phi \\
\end{bmatrix}, 
\mathbb{T}_{\mathbf{y}}(\phi)=\begin{bmatrix}
\cos\phi & 0 & -\sin\phi \\
0 & 1 & 0\\
\sin\phi & 0 & \cos\phi \\
\end{bmatrix}, 
\mathbb{T}_{\mathbf{z}}(\phi)=\begin{bmatrix}
\cos\phi & \sin\phi & 0\\
- \sin\phi & \cos\phi & 0\\
0 & 0 & 1\\
\end{bmatrix}
\end{equation}

\nomenclature[Ga4]{$\phi$}{General Euler angle \nomunit{rad}}

%More information on the different reference frames and the transformation matrices can be found in \Cref{app:appendixAA-referenceSystemTransformations}. \\
\noindent
Besides different reference frames, there are also different coordinate systems in which the state of a vehicle can be expressed. Three of the most used coordinate systems in space flight problems are the cartesian, spherical and keplerian system, and all of those systems (or formulations) are used in this research.\\ 
This also means that the state should be transformed between these different coordinate sets. In \Cref{fig:sphertocart_noomen2013basicFirst} it is shown how the position of a point can be described in either spherical coordinates or cartesian coordinates.


\begin{figure}[H]
\centering
\includegraphics[width=0.3\textwidth]{figures/reference_frames/sphertocart_noomen2013basic.jpg}
\caption{Position expressed either in the cartesian (x,y,z) or in the spherical system ($r$, $\delta$, $\lambda$) \citep{noomen2013basic}.}
\label{fig:sphertocart_noomen2013basicFirst}
\end{figure}

\noindent
From this figure the relation can be described between the two different systems. This relation is important to allow for the translation between parameters expressed in one system to the other. More information on the transformations and coordinate system relations can be found in \Cref{app:appendixAA-referenceSystemTransformations}.
%
%If the cartesian coordinates are known, the spherical coordinates can be computed using \Cref{eq:cart2spher}.
%
%\begin{equation} \label{eq:cart2spher}
%\begin{split}
%r &= \sqrt{x^{2}+y^{2}+z^{2}}\\
%\delta &= \arcsin \left(\dfrac{z}{r}\right)\\
%\lambda &= \arctan \left(\dfrac{y}{x}\right)\\
%\end{split}
%\end{equation}

\nomenclature[Rb1]{$x$}{x-position coordinate \nomunit{m}}
\nomenclature[Rb5]{$y$}{y-position coordinate \nomunit{m}}
\nomenclature[Rb5]{$z$}{z-position coordinate \nomunit{m}}
\nomenclature[Ra5]{$r$}{Radius \nomunit{m}}
\nomenclature[Ga1]{$\delta$}{Latitude \nomunit{rad}}
\nomenclature[Ga3]{$\lambda$}{Inertial longitude \nomunit{rad}}

The general model is described in the Mars centred inertial frame in terms of the cartesian state (position and velocity in the x-, y-, and z-direction) and the mass. This is done because the cartesian state formulation in itself does not contain any singularities and will be used in the numerical integrator that will be compared to \ac{TSI}. However, different formulations based on the general model will be used for the propagation tool using \ac{TSI} as will be described in \Cref{ch:tsi}. The general cartesian notation is shown in \Cref{eq:stateModel}, where $m_{MAV}$ is the mass of the \ac{MAV} and the subscript $I$ refers to the inertial frame. This frame is used because the target orbit is a circular orbit around Mars described in the Mars centred inertial frame.

\begin{align} \label{eq:stateModel}
\mathbf{r}&=\begin{pmatrix}
x_{I}\\
y_{I}\\
z_{I}\\
\end{pmatrix}
&
\mathbf{V}&=\begin{pmatrix}
V_{x_{I}} \\
V_{y_{I}} \\
V_{z_{I}}\\
\end{pmatrix}
&
m_{MAV}&
\end{align}

\nomenclature[Rb0]{$V$}{Velocity \nomunit{m/s}}
\nomenclature[Ra4]{$m_{MAV}$}{\ac{MAV} mass \nomunit{kg}}


\noindent
To determine the next state, the change in the state parameters over time have to be computed. This is done by taking the time derivatives of the state as described by \Cref{eq:state_derivativesModel}.

\begin{align} \label{eq:state_derivativesModel}
\begin{split} 
\dot{x}_{I}&=V_{x_{I}}\\
\dot{y}_{I}&=V_{y_{I}}\\
\dot{z}_{I}&=V_{z_{I}}
\end{split} 
&
\begin{split}
\ddot{x}_{I}&=\dot{V}_{x_{I}}=a_{x_{I}}\\
\ddot{y}_{I}&=\dot{V}_{y_{I}}=a_{y_{I}}\\
\ddot{z}_{I}&=\dot{V}_{z_{I}}=a_{z_{I}}
\end{split}
&
\dot{m}_{MAV}=-\dfrac{T}{g_{0}I_{sp}}
\end{align}

\nomenclature[Ra0]{$a$}{Acceleration \nomunit{m/s$^{2}$}}
\nomenclature[Ca7]{$g_{0}$}{Standard gravitational acceleration at Earth sea level \nomunit{9.80665 m/s$^{2}$}}
\nomenclature[Ra8]{$T$}{Thrust \nomunit{N}}
\nomenclature[Ra2]{$I_{sp}$}{Specific impulse \nomunit{s}}



\noindent
From this point on, the subscript $I$ is omitted, because the state and the state derivatives are always presented in the inertial frame. If variables have to be presented in any other reference frame the corresponding subscripts will be provided and explained. The accelerations in the x-, y- and z-direction have three contributing components: gravitational acceleration, drag acceleration and thrust acceleration. In this model it is assumed that there is a homogeneous gravitational field acting on the point mass with a direction towards the centre of the inertial frame, which in this case is equal to the centre of Mars. The gravitational acceleration can therefore be directly expressed in the inertial frame. 

The drag is assumed to work in the opposite direction of the \ac{MAV} velocity vector, which in turn is assumed to be in the positive x-direction of the body frame associated with the \ac{MAV} (angle of attack and side-slip angle are assumed to be zero, so the aerodynamic frame is in this research the same as the body frame). Therefore the \ac{MAV} velocity, or ground velocity assuming there is no wind, is acting through the nose of the ascent vehicle. The drag acceleration is therefore expressed in the body frame. This effect in the body frame has to be translated into an acceleration in the inertial frame, which can be done using transformation matrices. A traditional transformation matrix uses an Euler angle to rotate a coordinate system in a certain reference frame to another. Using the proper Euler, or rotation, angles, the acceleration in the x-, y- and z-direction in the body frame can be transformed into acceleration components acting in the x-, y- and z-direction of the inertial frame. Once it is expressed in the inertial frame it can be added to the effect caused by the gravitational acceleration. 

It is also assumed that the nozzle of the \ac{MAV} engine can be pivoted in two different directions: the y-, and z-direction of the body frame using the thrust elevation angle $\epsilon_{T}$ and the thrust azimuth angle $\psi_{T}$. This means that the thrust acceleration can better be expressed in what is called the propulsion frame (see \Cref{subfig:propframe_mooij1994motion}). Because the nozzle can move in two directions, or rather pivot over two different angles, the thrust acceleration can be translated to the body frame using these two thrust angles. Once the thrust acceleration is expressed in the body frame, the same transformations that are used for the drag acceleration can be used to determine the thrust acceleration components in the inertial frame. \\

\noindent
Combining this in one equation then results in the expression for the acceleration vector as shown by \Cref{eq:accModel}. The subscript $G$ shows that the parameter is a function of the ground velocity, which in this case is equal to the velocity in the rotating frame of the \ac{MAV} itself because no wind is assumed. $\mathbb{T}$ stands for a transformation and the subscript determines the rotation axis. The parameter in the brackets for each transformation is the rotation angle, and each vertical line with a letter below it indicates the reference frame. 

\begin{multline} \label{eq:accModel}
\begin{pmatrix}
a_{x}\\
a_{y}\\
a_{z}\\
\end{pmatrix}
=
\begin{pmatrix}
a_{x,Grav}\\
a_{y,Grav}\\
a_{z,Grav}\\
\end{pmatrix}+
\Bigg|_{\mathbf{I}}\mathbb{T}_{\mathbf{z}}\left(-\Omega_{M}t_{O}+\omega_{P}\right)\Bigg|_{\mathbf{R}}\mathbb{T}_{\mathbf{z}}\left(-\tau\right)\mathbb{T}_{\mathbf{y}}\left(\dfrac{\pi}{2}+\delta\right)\Bigg|_{\mathbf{V}}\mathbb{T}_{\mathbf{z}}\left(-\chi_{G}\right)\mathbb{T}_{\mathbf{y}}\left(-\gamma_{G}\right)\Bigg|_{\mathbf{B}}\left[
\begin{pmatrix}
a_{Drag}\\
0\\
0\\
\end{pmatrix}
+  \right. \dots \\
\dotsc
 \left.
\Bigg|_{\mathbf{B}}\mathbb{T}_{\mathbf{z}}\left(-\psi_{T}\right)\mathbb{T}_{\mathbf{y}}\left(-\epsilon_{T}\right)\Bigg|_{\mathbf{P}}
\begin{pmatrix}
a_{Thrust}\\
0\\
0\\
\end{pmatrix}
\right]
\end{multline}

\nomenclature[Ca7]{$\Omega_{M}$}{Rotational velocity of Mars \nomunit{7.088$\cdot$10$^{-5}$ rad/s}}
\nomenclature[Ra7]{$t_{O}$}{Difference between current time and the inertial frame set time \nomunit{s}}
\nomenclature[Ga6]{$\omega_{P}$}{Off-set angle between inertial frame and zero meridian at inertial frame set time \nomunit{rad}}
\nomenclature[Ga4]{$\chi$}{Heading angle (or azimuth) \nomunit{rad}}
\nomenclature[Ga0]{$\gamma$}{Flight-path angle \nomunit{rad}}
\nomenclature[Ga3]{$\tau$}{Central-body fixed longitude \nomunit{rad}}
\nomenclature[Ga5]{$\psi_{T}$}{Thrust azimuth angle \nomunit{rad}}
\nomenclature[Ga2]{$\epsilon_{T}$}{Thrust elevation angle \nomunit{rad}}



\noindent
The rotations required to go from the body frame to the inertial frame are all a function of the current state. Both thrust angles are an input value that is set by the user or the program. $-\Omega_{M}t_{O}+\omega_{P}$ represents the angle between the rotating frame and the inertial frame and consists of three parts: $\Omega_{M}$ is the rotational velocity of Mars around its own axis, $t_{O}$ is the difference between the current time and the time at which the inertial frame was set on Mars, and $\omega_{P}$ is the angle between the x-axis of the inertial frame and the zero meridian at the time that the inertial frame was set on Mars. In this thesis the inertial frame is set at the beginning of the simulation (so at $t=0$, $t_{O}=0$) and is aligned with the rotating frame (so $\omega_{P}=0$). This means that the two reference frames shown in \Cref{subfig:eci_mooij2013fd_noBox,subfig:ecef_mooij2013fd_noBox} are alligned at the start of the simulation. The transformation from the vertical to the rotating frame requires the latitude and longitude of the \ac{MAV}, which is a function of the current state. \cite{mooij1994motion} provides equations to determine the different rotation angles. These expressions can be used to compute the latitude and longitude as well, as shown by \Cref{eq:latAndLong}.

\begin{align} \label{eq:latAndLong}
\begin{split} 
r&=\sqrt{x^{2}+y^{2}+z^{2}}\\
\delta&=\arcsin\left(\dfrac{z}{r}\right)
\end{split} 
&
\begin{split}
x_{R}&=\cos\left(\Omega_{M}t_{O}\right)x+\sin\left(\Omega_{M}t_{O}\right)y\\
y_{R}&=-\sin\left(\Omega_{M}t_{O}\right)x+\cos\left(\Omega_{M}t_{O}\right)y\\
\tau&=\text{atan2}\left(\dfrac{y_{R}}{x_{R}}\right)
\end{split}
\end{align}

\noindent 
It can be seen that to compute the longitude in the rotating frame ($\tau$) the position of the \ac{MAV} in the rotating frame is required. This position is found by transforming the inertial position to the rotational position using $\Omega_{M}t_{O}$ as described before. Working out that transformation matrix results in the sines and cosines presented in \Cref{eq:latAndLong}.\\

\noindent
Similarly, the flight-path angle $\gamma_{G}$ and the azimuth angle $\chi_{G}$ can be described as a function of the current state. For this, some intermediate parameters have to be computed first, which are given by \Cref{eq:intermediateParameters}. Here $V_{I}$ is the velocity in the inertial frame, $V_{G}$ is the velocity in the rotating frame and $V_{x,V}$, $V_{y,V}$ and $V_{z,V}$ are the respective x-, y- and z-velocity components in the vertical frame as depicted by \Cref{fig:vertical_spherical_mooij1994motion}.

\begin{equation} \label{eq:intermediateParameters}
\begin{split}
V_{I}=&\sqrt{V_{x}^{2}+V_{y}^{2}+V_{z}^{2}}\\
V_{G}=&\sqrt{V_{I}^{2}+\Omega_{M}^{2}\left(x^{2}+y^{2}\right)+2\Omega_{M}\left(xy-yx\right)}\\
V_{x,V}=&\left(V_{x}+\Omega_{M}y\right)\cdot \left(\sin\left(\delta\right)\sin\left(\Omega_{M}t_{O}\right)\sin\left(\tau\right)-\cos\left(\Omega_{M}t_{O}\right)\cos\left(\tau\right)\sin\left(\delta	\right)\right)+\\
&\left(V_{y}-\Omega_{M}x\right)\cdot \left(-\cos\left(\tau\right)\sin\left(\delta\right)\sin\left(\Omega_{M}t_{O}\right)-\cos\left(\Omega_{M}t_{O}\right)\sin\left(\delta\right)\sin\left(\tau\right)\right)+V_{z}\cos\left(\delta\right)\\
V_{y,V}=&\left(V_{x}+\Omega_{M}y\right)\cdot \left(-\cos\left(\tau\right)\sin\left(\Omega_{M}t_{O}\right)-\cos\left(\Omega_{M}t_{O}\right)\sin\left(\tau\right)\right)+\\
&\left(V_{y}-\Omega_{M}x\right)\cdot \left(\cos\left(\Omega_{M}t_{O}\right)\cos\left(\tau\right)-\sin\left(\Omega_{M}t_{O}\right)\sin\left(\tau\right)\right)\\
V_{z,V}=&\left(V_{x}+\Omega_{M}y\right)\cdot \left(\cos\left(\delta\right)\sin\left(\Omega_{M}t_{O}\right)\sin\left(\tau\right)-\cos\left(\Omega_{M}t_{O}\right)\cos\left(\tau\right)\cos\left(\delta	\right)\right)+\\
&\left(V_{y}-\Omega_{M}x\right)\cdot \left(-\cos\left(\tau\right)\cos\left(\delta\right)\sin\left(\Omega_{M}t_{O}\right)-\cos\left(\Omega_{M}t_{O}\right)\cos\left(\delta\right)\sin\left(\tau\right)\right)-V_{z}\sin\left(\delta\right)\\
\end{split}
\end{equation}

 \begin{figure}[H]
\centering
\includegraphics[width=0.5\textwidth]{figures/reference_frames/vertical_spherical_mooij1994motion.jpg}
\caption{Spherical velocity variables in a vertical cartesian frame \citep{mooij1994motion}.}
\label{fig:vertical_spherical_mooij1994motion}
\end{figure}

\noindent
Then the angles can be computed using these parameters as shown by \Cref{eq:fpaAndazimuth}.


\begin{equation} \label{eq:fpaAndazimuth}
\begin{split}
\chi_{G}&=\text{atan2}\left(\dfrac{V_{y,V}}{V_{x,V}}\right)\\
\gamma_{G}&=-\arcsin\left(\dfrac{V_{z,V}}{V_{G}}\right)\\
\end{split}
\end{equation}

\noindent
In this case, a transformation from the inertial frame to the vertical frame was required to get information on the velocity in the vertical frame. This transformation was written out in sines and cosines in \Cref{eq:intermediateParameters} resulting in lengthy expressions. \\

\noindent
Now that the rotation angles from the body frame to the inertial frame are known, only the thrust angles and the different accelerations have yet to be defined. This is done in the next sections.


\section{Gravity}
\label{sec:gravityModel}
The gravity acceleration is a function of the position of the \ac{MAV} and the standard gravitational parameter of the planet, in this case Mars. Often, irregularities in the mass distribution of a planet also have to be taken into account ($J_{2,0}$ etc.), however, because the mission time is very short and the \ac{MAV} does not even complete one revolution around Mars, these effects can be neglected. Therefore, the gravitational acceleration in the inertial frame can be represented by \Cref{eq:gravityModel}.

\begin{equation} \label{eq:gravityModel}
\begin{pmatrix}
a_{x,Grav}\\
a_{y,Grav}\\
a_{z,Grav}\\
\end{pmatrix}
=
\begin{pmatrix}
-\mu\dfrac{x}{r^{3}} \vspace{5pt} \\ \vspace{5pt} 
-\mu\dfrac{y}{r^{3}}\\
-\mu\dfrac{z}{r^{3}}\\
\end{pmatrix}
\end{equation}

% \vspace{5pt} is used to create vertical spacing between the different lines in the vector equation

%\nomenclature[Ca7]{$\mu_{M}$}{Mars standard gravitational parameter \nomunit{4.2828314$\cdot$10$^{-5}$km$^{3}$/s$^{2}$}}

\nomenclature[Ca7]{$\mu$}{Mars standard gravitational parameter \nomunit{4.2828314$\cdot$10$^{13}$m$^{3}$/s$^{2}$}}


\section{Thrust}
\label{sec:thrustModel}
The thrust acceleration in the propulsion frame is simply the thrust divided by the current mass of the \ac{MAV}, which can be written as shown by \Cref{eq:thrustModel}.

\begin{equation} \label{eq:thrustModel}
a_{Thrust}=\dfrac{T}{m_{MAV}}
\end{equation}

\noindent
However, this acceleration has to be transformed to the body frame using the thrust angles as defined in \Cref{subfig:propframe_mooij1994motion}. Both the thrust elevation as well as the thrust azimuth angle will be manually optimised to fit the trajectory and then set as a constant value during the entire ascent trajectory. They are thus not a function of the initial conditions but follow from the reference trajectory. The value for the thrust $T$ depends on the chosen \ac{MAV} design and can be different depending on the reference case. It will be set as a constant value during the ascent. 

%\begin{figure}[H]
%\centering
%\includegraphics[width=0.5 \textwidth]{figures/reference_frames/propframe_mooij1994motion.jpg}
%\caption{Definition of the thrust elevation and thrust azimuth angle with respect to the body frame \citep{mooij1994motion}.}
%\label{fig:propframe_mooij1994motion}
%\end{figure}

\noindent
These angles will not be computed, but are set as an input for the program.


\section{Atmospheric Drag}
\label{sec:dragModel}
The drag acceleration can be represented similarly to the thrust acceleration taking into account that the drag is acting in the negative x-direction in the aerodynamic frame. The acceleration can then be written as \Cref{eq:dragModel}.

\begin{equation} \label{eq:dragModel}
a_{drag}=-\dfrac{D}{m_{MAV}}
\end{equation}

\nomenclature[Ra1]{$D$}{Drag \nomunit{N}}

\noindent
Here the drag is given by \Cref{eq:dragDragModel}, where the value for $V_{A}$ is in this case equal to $V_{G}$ because it is assumed that there is no wind.

\begin{equation} \label{eq:dragDragModel}
D=\dfrac{1}{2}\rho V_{A}^{2}SC_{D}
\end{equation}

\nomenclature[Ga3]{$\rho$}{Atmospheric density \nomunit{kg/m$^{3}$}}
\nomenclature[Ca7]{$S$}{Reference area \nomunit{0.091 m$^{2}$}}
\nomenclature[Ra1]{$C_{D}$}{Drag coefficient \nomunit{-}}

\noindent
Also, $S$ is the reference area of the \ac{MAV} set by the user, $\rho$ is the atmospheric density which is a function of the altitude $h\left(=r-R_{MOLA}\right)$ and $C_{D}$ is the drag coefficient of the \ac{MAV} which is a function of the Mach number. The Mach number in turn is a function of the speed of sound, which depends on the air temperature as can be seen in \Cref{eq:machAndSpeedOfSound}.

\nomenclature[Ca7]{$R_{MOLA}$}{Mars \acs{MOLA} reference radius (also $R_{M}$) \nomunit{3396$\cdot$10$^{3}$ m}}
\nomenclature[Ra1]{$h$}{Altitude \nomunit{m}}




 \begin{equation} \label{eq:machAndSpeedOfSound}
\begin{split}
M &= \dfrac{V_{A}}{a} \\
a &= \sqrt{\gamma_{a}R_{a}^{*}T_{a}} \quad \text{where} \quad R_{a}^{*}=\dfrac{R_{a}}{M_{a}} \\
\end{split}
\end{equation}

\nomenclature[Ra5]{$M$}{Mach number \nomunit{-}}
\nomenclature[Ra0]{$a$}{Speed of sound \nomunit{m/s}}
\nomenclature[Ca7]{$\gamma_{a}$}{Ratio of specific heats \nomunit{1.35}}
\nomenclature[Ca7]{$R_{a}$}{Molar gas constant \nomunit{8.3144598 m$^{2}$ kg s$^{-2}$ K$^{-1}$ mol$^{-1}$}}
\nomenclature[Ca7]{$M_{a}$}{Molecular mass of the Martian atmosphere \nomunit{0.04334 kg/mol}}
\nomenclature[Ra8]{$T_{a}$}{Atmospheric temperature \nomunit{K}}
\nomenclature[Ra6]{$R_{a}^{*}$}{Specific gas constant \nomunit{m$^{2}$ s$^{-2}$ K$^{-1}$}}
\nomenclature[Ra5]{$p_{n}$}{Polynomial coefficient \nomunit{-}}





\noindent
Here, $R_{a}$ is the molar gas constant, $\gamma_{a}$ is the ratio of specific heats for the Martian atmosphere, which according to \cite{ho2002radio} can be set to $\sim$1.35. $M_{a}$ is the molecular mass of the Martian atmosphere and depends on its composition. \cite{williams2015} mentions a volumetric composition of Mars which results in a mean molecular mass of 0.04334 kg/mol. This value has been used in this research to compute the Specific gas constant $R_{a}^{*}$.\\

\noindent
The temperature ($T_{{a}}$) change as a function of the altitude. This means that a temperature model of the atmosphere of Mars will have to be used to approximate these values as the ascent vehicle moves through the atmosphere. This is done through a function fit of an atmospheric model, as is described in \Cref{subsec:atmofuncfit}.\\

\noindent
The drag coefficient changes with the Mach number. Therefore, this also requires a function fit to be used in the simulation program. This fit is presented in \Cref{subsec:dragCoefFuncFit}.

\subsection{Atmospheric Density and Temperature Function Fit}
\label{subsec:atmofuncfit}
Several commercially available Mars atmospheric models are available that can be used to simulate the Martian atmosphere for use in, for instance, trajectory calculations. One of these models is the 2005 Mars-\acf{GRAM} \citep{justus1990mars} of which the 2005 version is free to use. This model is often used by the TU Delft and \ac{JPL} and has also been used by some of the reference research such as \cite{desai1998} and \cite{trinidad2012}.
Using Mars-\ac{GRAM} 2005, a table containing altitude, latitude and longitude dependent temperature and density data was produced. The altitude range was -0.6 to 320 km \acr{MOLA} with a step-size of 0.01 km, the latitude and longitude ranges were centred around the example launch site (21.0 $^\circ$N and 74.5 $^\circ$E) with a 10-degree range in each direction and a step-size of 1 degree. The rest of the input parameters were constant and can be seen in \Cref{app:appendixA-marsGRAM-inputFile}. The temperature and density data produced are shown in \Cref{fig:temperatureData,fig:densityData} respectively for nine latitude and longitude combinations including the reference launch site itself. This is therefore a sub-set of the full data volume available in Mars-\ac{GRAM} 2005.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          


\begin{figure}[H]
\centering
\includegraphics[width=0.7\textwidth]{figures/software/temperatureData.png}
\caption{Temperature data generated with Mars-\ac{GRAM} 2005 showing different latitude and longitude combinations.}
\label{fig:temperatureData}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width=0.7\textwidth]{figures/software/densityData.png}
\caption{Density data generated with Mars-\ac{GRAM} 2005 showing different latitude and longitude combinations.}
\label{fig:densityData}
\end{figure}

\noindent
Unfortunately, data tables cannot be used when integrating using \ac{TSI}, which is why both these data sets had to be fitted with differentiable functions. The temperature data cannot be fitted smoothly with one function.  Therefore, depending on the altitude range, a different approximation function is required. 

This calls for a polynomial function fitting for different sections of the temperature curve. Polynomial functions are easily differentiated and can be set-up with a large approximation precision of the curve section. The condition to be met for a proper fit came from the differences in the temperature-altitude and density-altitude curves, where the maximum difference with respect to the launch site curve was taken. The first requirement for the standard deviation of the polynomial curve fit was then to be (at least) one order lower than this maximum difference. The second requirement is that the maximum difference between the fit and the nominal launch site curve is lower than the initial maximum difference. The temperature-altitude curve was split into 5 sections as roughly visualised in \Cref{fig:temperatureDataSplit5}. The number of sections comes from both the shape of the curves and the requirement for accuracy and maximum order of the polynomial, which is set at 8 because otherwise the polynomial would get too long. This could result in longer run times and under-representation of certain parts of the curve. Also, the number of sections were to be kept at a minimum to avoid having to switch between too many sections slowing down the computation process. More information on the fitting process is provided in \Cref{app:appendixB-fittingProcessAndResults}.

\begin{figure}[H]
\centering
\includegraphics[width=1.0\textwidth]{figures/software/temperatureDataSplit5.png}
\caption{Different temperature curve sections.}
\label{fig:temperatureDataSplit5}
\end{figure}

\noindent
Each section was fitted with a polynomial function of order n as represented by \Cref{eq:polyGenFunct}. The last section shows a constant temperature, thus the temperature of the launch site curve was chosen to represent this final section, which is equal to 136.5 K.

\begin{equation} \label{eq:polyGenFunct}
y= p_{0}+p_{1}x+\dots+p_{n-1}x^{n-1}+p_{n}x^{n}
\end{equation}

\noindent
A low order is preferred, because then the fitted function will be simpler to evaluate and contain fewer terms. However the order has to be high enough to meet the accuracy requirements. To achieve this, the maximum difference between the data curves had to be higher than twice the maximum polynomial standard deviation to obtain approximately 95\% accuracy in the fit. \Cref{tab:fitDeviations} shows the orders that were required and the deviations to the launch site temperature-altitude curve. The actual corresponding parameters are provided in \Cref{tab:fitParameters}. It should be noted that the first few temperature data values were so different from the rest of the curve that it was assumed that this is due to uncertainty in the Mars-\ac{GRAM} program and were thus treated as outliers. The provided polynomial fit is only directly a function of the altitude, but because it is fit using different latitude and longitude curves it is indirectly also a function of the longitude and latitude variation. The complete polynomial fit for the launch site curve for the temperature is shown in \Cref{fig:completePolyFitTempSplit5}.

\begin{table}[H]
\begin{center}
\caption{Temperature curve fit data all with respect to the launch site curve (latitude and longitude of the launch site).}
\label{tab:fitDeviations}
\begin{tabularx}{1.0\textwidth}{|l|p{2.2cm}|l|X|X|X|}
\hline 
\small \textbf{Section} & \small \textbf{Altitude range [km MOLA]} & \small \textbf{Order}	& \small \textbf{Maximum polynomial standard deviation [K]} & \small \textbf{Maximum polynomial difference [K]} & \small \textbf{Maximum data curves difference [K]} \\ \hline 
1 & -0.6 to 5.04 & 1 & 0.0312 & 25.8 & 0.177 \\ \hline
2 & 5.04 to 35.53 & 2 & 0.287 & 3.90 & 0.7056 \\ \hline
3 & 35.53 to 75.07 & 6 & 0.624 & 8.00 & 1.69 \\ \hline
4 & 75.07 to 170.05 & 8 & 0.523 & 6.60 & 2.45 \\ \hline
5 & $>$ 170.05 & 0 & 0.0 & 5.5 & 5.5 \\ \hline
\end{tabularx}
\end{center}
\end{table}

\begin{table}[H]
\begin{center}
\caption{Temperature curve fit parameters (rounded to 3 decimal points)}
\label{tab:fitParameters}
\begin{tabular}{|l||p{1.1cm}|p{1.1cm}|p{1.1cm}|p{1.1cm}|p{1.1cm}|p{1.1cm}|p{1.1cm}|p{1.1cm}|p{1.1cm}|}
\hline 
\textbf{Section}  & $\mathbf{p_{0}}$ & $\mathbf{p_{1}}$ & $\mathbf{p_{2}}$ & $\mathbf{p_{3}}$ & $\mathbf{p_{4}}$ & $\mathbf{p_{5}}$ & $\mathbf{p_{6}}$ & $\mathbf{p_{7}}$ & $\mathbf{p_{8}}$ \\ \hline 
1 & 194.165   &  3.415 &  &  &  &  & & &  \\ \hline
2 & 222.052 & -2.130 & 0.006 &  &  & &  &  &    \\ \hline
3 & -1.167 $\cdot$10$^{4}$ & 1.407 $\cdot$10$^{3}$ & -68.294 & 1.733 & -0.0243 &  1.785 $\cdot$10$^{-4}$ & -5.388 $\cdot$10$^{-7}$  &  & \\ \hline
4  & 2.236 $\cdot$10$^{5}$ & -1.523 $\cdot$10$^{4}$ & 447.378 & -7.405 & 0.076 & -4.862 $\cdot$10$^{-4}$ & 1.931 $\cdot$10$^{-6}$ & -4.328 $\cdot$10$^{-9}$ & 4.1942 $\cdot$10$^{-12}$ \\ \hline
5 & 136.5 &&&&&&&& \\ \hline
\end{tabular}
\end{center}
\end{table}


\begin{figure}[H]
\centering
\includegraphics[width=0.7\textwidth]{figures/software/completePolyFitTempSplit5.png}
\caption{All section fits for the launch site temperature data curve}
\label{fig:completePolyFitTempSplit5}
\end{figure}



\noindent
The density fit was slightly more difficult because the curves are all very similar and thus result in a higher accuracy requirement for the fit. At first glance it looks like a natural logarithmic function, unfortunately an ordinary exponential did not fit the curve. This is why a more extensive exponential fit was required. The natural logarithm of the data has been plotted in \Cref{fig:lnPlotDataDen}.

\begin{figure}[H]
\centering
\includegraphics[width=0.7\textwidth]{figures/software/lnPlotDataDen.png}
\caption{Natural logarithmic plot of the density data}
\label{fig:lnPlotDataDen}
\end{figure}

\noindent
With the data represented in the logarithmic domain, again a polynomial function can be fitted. The total fit then satisfies \Cref{eq:expPoly}.

\begin{equation} \label{eq:expPoly}
y=\exp\left(p_{0}+p_{1}x+\dots+p_{n-1}x^{n-1}+p_{n}x^{n}\right)
\end{equation}



% A logarithmic fit (such as an exponential atmosphere) resulted in a lower overall accuracy than the polynomial fits. In this case the curve was split into three sections, because the differences between the curves were bigger in the lower atmosphere. These sections are illustrated in \Cref{fig:densityDataSplit3}.
%
% \begin{figure}[H]
%\centering
%\includegraphics[width=1.0\textwidth]{figures/software/densityDataSplit3.png}
%\caption{Different density curve sections}
%\label{fig:densityDataSplit3}
%\end{figure} 

\noindent
The same polynomial requirements as for the temperature curve were enforced for the density curve as well. However, because the polynomial is used in an exponential, some extra requirements are needed to assure the accuracy of the fit. One requirement is that the maximum difference between the final exponential fit and the normal launch site density curve is smaller than the maximum difference between all the data curves. Also, in this case the standard deviation of the difference between the exponential fit and the normal launch site curve had to be within the range of standard deviations of the difference between the different data curves. This meant that even though an 8$^{\text{th}}$-order polynomial fit could be achieved for the natural logarithmic data with the required accuracy, when converted to the exponential fit, the last two requirements were not met. Earlier it was mentioned that an order higher than 8 was not desirable. However, in this case, a single exponential fit could be achieved using a 10$^\text{th}$-order polynomial. This fit meant that the density curve did not have to be split up at all, which makes the integration slightly easier. Therefore, it was decided that a 10$^\text{th}$-order polynomial was acceptable in this case. The results of the fit are presented in \Cref{tab:fitDeviationsDen,tab:fitParametersDen} and the polynomial and exponential fit curves are shown in \Cref{fig:completeExpPolyFitDen,fig:completeExpFitDen} respectively.

%
% This results in the density polynomial fit data and the polynomial parameters as presented in \Cref{tab:fitDeviationsDen,tab:fitParametersDen} respectively. 

%\textbf{\textcolor{red}{UPDATE THE NEXT TWO TABLE VALUES TO THE VALUES FOR DENSITY!!!}}

%\begin{table}[H]
%\begin{center}
%\caption{Density curve fit data (10$^{th}$ order polynomial)}
%\label{tab:fitDeviationsDen}
%\begin{tabular}{|p{3cm}|p{3cm}|p{3cm}|p{3cm}|p{3cm}|p{3cm}|p{3cm}|}
%\hline 
%\textbf{Maximum polynomial standard deviation [kg/m$^{3}$]} & \textbf{Maximum natural logarithmic curves difference [kg/m$^{3}$]} & \textbf{Maximum polynomial difference with natural logarithmic launch site curve [kg/m$^{3}$]} & \textbf{Maximum curves difference [kg/m$^{3}$]} & \textbf{Maximum difference with launch site curve [kg/m$^{3}$]} & \textbf{Maximum standard deviation curves difference [kg/m$^{3}$]} & \textbf{Standard deviation exponential fit difference [kg/m$^{3}$]} \\ \hline 
%0.0501 & 0.460 & 0.160   & 3.910$\cdot$10$^{-3}$ &  2.826$\cdot$10$^{-3}$ & 2.106$\cdot$10$^{-4}$ & 1.167$\cdot$10$^{-4}$ \\ \hline
%
%\end{tabular}
%\end{center}
%\end{table}

\begin{table}[H]
\begin{center}
\caption{Density curve fit data (10$^\text{th}$-order polynomial) with respect to the launch site curve (Latitude and longitude of the launch site)}
\label{tab:fitDeviationsDen}
{\renewcommand{\arraystretch}{1.2} % used to increase vertical spacing
\begin{tabular}{|l|l|}
\hline
\textbf{Parameter} & \textbf{Value} \\ \hline \hline 
Maximum polynomial standard deviation [ln(kg/m$^{3}$)] & 0.0501 \\ \hline

  Maximum polynomial difference [ln(kg/m$^{3}$)] & 0.160 \\ \hline
  
Maximum natural logarithmic data curves difference [ln(kg/m$^{3}$)] & 0.460 \\ \hline
  
Maximum exponential difference with launch site curve [kg/m$^{3}$] & 2.826$\cdot$10$^{-3}$ \\ \hline
    
Maximum data curves difference [kg/m$^{3}$] & 3.910$\cdot$10$^{-3}$ \\ \hline
    
Standard deviation exponential fit difference [kg/m$^{3}$] & 1.167$\cdot$10$^{-4}$ \\ \hline 
      
Maximum standard deviation data curves difference [kg/m$^{3}$] & 2.106$\cdot$10$^{-4}$ \\ \hline
\end{tabular}}
\end{center}
\end{table}



\begin{table}[H]
\begin{center}
\caption{Density curve fit parameters (rounded to 3 decimal points)}
\label{tab:fitParametersDen}
{\renewcommand{\arraystretch}{1.2} % used to increase vertical spacing
\begin{tabular}{|l|l|l|l|l|l|}
\hline 
 $\mathbf{p_{0}}$ & $\mathbf{p_{1}}$ & $\mathbf{p_{2}}$ & $\mathbf{p_{3}}$ & $\mathbf{p_{4}}$ & $\mathbf{p_{5}}$  \\ \hline
 -4.172 & -0.0962 & 1.414 $\cdot$10$^{-3}$ & -9.604 $\cdot$10$^{-5}$ & 2.273 $\cdot$10$^{-6}$ & -2.884 $\cdot$10$^{-8}$  \\ \hline 
\end{tabular}
}
\end{center}
\end{table} 
 
 
 \begin{table}[H]
\begin{center}
{\renewcommand{\arraystretch}{1.2} % used to increase vertical spacing
\begin{tabular}{|l|l|l|l|l|}
 \hline
  $\mathbf{p_{6}}$ & $\mathbf{p_{7}}$ & $\mathbf{p_{8}}$ & $\mathbf{p_{9}}$ & $\mathbf{p_{10}}$  \\ \hline 
2.146 $\cdot$10$^{-10}$ & -9.620 $\cdot$10$^{-13}$ & 2.559 $\cdot$10$^{-15}$  & -3.724 $\cdot$10$^{-18}$ & 2.287 $\cdot$10$^{-21}$  \\ \hline 
\end{tabular}
}
\end{center}
\end{table}

%The complete polynomial fit for the launch site curve for the density is shown in \Cref{fig:completePolyFitDen}.


\begin{figure}[H]
\centering
\includegraphics[width=0.7\textwidth]{figures/software/completeExpPolyFitDen.png}
\caption{Polynomial fit for the launch site density data curve.}
\label{fig:completeExpPolyFitDen}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width=0.7\textwidth]{figures/software/completeExpFitDen.png}
\caption{Exponential fit for the launch site density data curve.}
\label{fig:completeExpFitDen}
\end{figure}


%\begin{figure}[H]
%\centering
%\includegraphics[width=1.0\textwidth]{figures/software/pressureData.png}
%\caption{Pressure data generated with Mars-\ac{GRAM} 2005 showing 9 different latitude and longitude combinations}
%\label{fig:pressureData}
%\end{figure}

\pagebreak

\subsection{Drag Coefficient Function Fit}
\label{subsec:dragCoefFuncFit}
Similar to the temperature and density curves, the relation between Mach number and drag coefficient, as depicted in \Cref{fig:dragcoeff_whitehead2004mars}, had to be modelled as a function as well. Again, it cannot be fitted using one single function, but instead had to be modelled by different functions. \\

\noindent
Fortunately, this curve is already an approximation and thus consists of linear elements only. It can be split up into six different sections where the first and last section are constant ($C_{D}$ is 0.2 and 0.3 respectively). Using a similar polynomial fit as before, but now for 1 order only, a linear fit could be made for each of the remaining four sections. The corresponding parameters are shown in \Cref{tab:dragCoeffPara} and the curve fit is shown in \Cref{fig:dragCoeffFit}.


\begin{table}[H]
\begin{center}
\caption{Drag coefficient curve fit parameters (rounded to 3 decimal points).}
\label{tab:dragCoeffPara}
\begin{tabular}{|l|l||l|l|}
\hline 
\textbf{Section}  & \textbf{Mach range}& $\mathbf{p_{0}}$ & $\mathbf{p_{1}}$ \\ \hline 
1 & 0 to 1  & 0.2 & 0.0 \\ \hline
2  & 0.5 to 1   & -2.483 $\cdot$10$^{-16}$ & 0.400 \\ \hline
3  & 1 to 1.3   & -0.167 & 0.567 \\ \hline
4  &  1.3 to 2.5  & 0.754 & -0.142 \\ \hline
5  &  2.5 to 4  & 0.567 & -0.0667 \\ \hline
6 & $>$4  & 0.3 & 0.0 \\ \hline
\end{tabular}
\end{center}
\end{table}



\begin{figure}[H]
\centering
\includegraphics[width=0.7\textwidth]{figures/software/dragCoeffFit.png}
\caption{All section fits for the drag coefficient - Mach curve.}
\label{fig:dragCoeffFit}
\end{figure}

\pagebreak

\section{Circularisation}
\label{sec:modelCircularisation}
After the integration has been completed (defined by reaching either the desired altitude, mission duration or horizontal flight conditions), a circularisation burn will take place to estimate the required propellant mass to arrive in the desired orbit. This will include the $\Delta V$ required to change the flight-path angle, change the inclination and adjust the orbital velocity. A simplified diagram of such a procedure is presented in \Cref{fig:deltaVcircularOrbitMars_wakker2010}. The equations used to perform this instantaneous burn are based on the equations presented by \cite{wakker2010}.

\nomenclature[Ga2]{$\Delta V$}{Change in velocity \nomunit{m/s}}
\nomenclature[Rb0]{$V_{x}$}{Velocity in x-direction \nomunit{m/s}}
\nomenclature[Rb0]{$V_{y}$}{Velocity in y-direction \nomunit{m/s}}
\nomenclature[Rb0]{$V_{z}$}{Velocity in z-direction \nomunit{m/s}}


\begin{figure}[H]
\centering
\includegraphics[width=0.3\textwidth]{figures/circularisation/deltaVcircularOrbitMars_wakker2010.png}
\caption{Circularisation into the desired orbit \citep{wakker2010}.}
\label{fig:deltaVcircularOrbitMars_wakker2010}
\end{figure}

\noindent
The first step is to convert the final cartesian state obtained at the end of the integration to Kepler elements. This conversion is a standard conversion that can be found in \cite{wakker2010} and requires the standard gravitational parameter of Mars ($\mu_{M}$), which is taken to be 4.2828314 km$^{3}$/s$^{2}$. Then using the vis-viva equation presented in \Cref{eq:visViva} the current orbital velocity of the launch trajectory can be computed. Here the subscript $co$ stands for "current orbit" and $a$ is the semi-major axis of the launch trajectory.

\begin{equation} \label{eq:visViva}
V_{co} = \sqrt{\mu_{M}\left(\dfrac{2}{r_{co}}-\dfrac{1}{a_{co}}\right)}
\end{equation}

\nomenclature[Ra0]{$a$}{Semi-major axis \nomunit{m}}

\noindent
Then the required orbital velocity is a simplified representation of the vis-viva equation because it is assumed that the required orbit is always circular, see \Cref{eq:simpVisViva}. Here $do$ stands for "desired orbit".

\begin{equation} \label{eq:simpVisViva}
V_{do}=\sqrt{\dfrac{\mu_{M}}{r_{do}}}
\end{equation} 

\noindent
Because a change in flight-path angle might be required, the current flight-path angle has to be included into the change in velocity as well. For this, the semi-latus rectum ($p$) of the current orbit has to be computed first and then the cosine of the flight-path angle can be computed as shown by \Cref{eq:cosFPA}.


\begin{equation}\label{eq:cosFPA}
\begin{split}
p_{co}&=a_{co}\left(1-e_{co}^{2}\right)\\
\cos \gamma_{co}&=\dfrac{\left(\dfrac{p_{co}}{r_{co}}\right)}{\left(\sqrt{2\left(\dfrac{p_{co}}{r_{co}}\right)-\left(1-e^{2}\right)}\right)}\\
\end{split}
\end{equation}

\noindent
The required $\Delta V$ needed to reach the desired orbit can now be computed using \Cref{eq:requiredDeltaV}.

\begin{equation} \label{eq:requiredDeltaV}
\Delta V = \sqrt{V_{do}^{2}+V_{co}^{2}-2V_{do}V_{co}\left[\cos \gamma_{co}+\cos\left(i_{do}-i_{co}\right)\right]}
\end{equation}

\nomenclature[Ra2]{$i$}{Inclination \nomunit{rad}}

\noindent
Finally, the required propellant mass can be computed using Tsiolkovsky's equation as shown by \Cref{eq:propellantMass}.

\begin{equation} \label{eq:propellantMass}
m_{prop} = m_{MAV}\left(1-e^{\dfrac{-\Delta V}{I_{sp}g_{0}}}\right)
\end{equation}

\nomenclature[Ra4]{$m_{prop}$}{Propellant mass \nomunit{kg}}
%
%m_{prop} = m_{MAV}-\dfrac{m_{MAV}}{e^{\dfrac{\Delta V}{I_{sp}g_{0}}}}

%
%\textbf{\textcolor{red}{This section still has to be added!!}}